# Encode

## ğŸ”¡ å¸¸è¦‹çš„ Encodingï¼ˆç·¨ç¢¼ï¼‰

ç·¨ç¢¼ï¼ˆEncodingï¼‰æ˜¯å°‡è³‡æ–™è½‰æˆæŸç¨®æ ¼å¼ï¼Œä»¥ä¾¿å„²å­˜æˆ–å‚³è¼¸ã€‚å®ƒä¸æ¶‰åŠå®‰å…¨æ€§ï¼Œåªæ˜¯è³‡æ–™æ ¼å¼çš„è½‰æ›ã€‚

| ç·¨ç¢¼æ–¹å¼                         | ç‰¹é»èˆ‡ç”¨é€”                                                        |
| ---------------------------- | ------------------------------------------------------------ |
| **Base64**                   | æœ€å¸¸è¦‹çš„ç·¨ç¢¼æ–¹å¼ã€‚å°‡äºŒé€²ä½è½‰æˆæ–‡å­—ï¼ˆA-Z, a-z, 0-9, +, /ï¼‰ã€‚å¸¸ç”¨æ–¼åœ–ç‰‡ã€JWTã€email å…§åµŒè³‡æ–™ã€‚ |
| **Hexï¼ˆåå…­é€²ä½ï¼‰**                | å°‡äºŒé€²ä½è½‰æˆ 0-Fã€‚å¸¸è¦‹æ–¼é›œæ¹Šå€¼ï¼ˆå¦‚ SHA-256ï¼‰è¡¨ç¤ºã€Ethereum addressã€‚             |
| **URL Encoding**             | æŠŠé URL å®‰å…¨å­—å…ƒè½‰æˆ `%XX`ã€‚ä¾‹å¦‚ç©ºç™½è®Š `%20`ï¼Œç”¨æ–¼ç¶²å€åƒæ•¸ã€‚                      |
| **UTF-8**                    | æœ€å¸¸è¦‹çš„ Unicode ç·¨ç¢¼æ ¼å¼ã€‚æ”¯æ´å…¨çƒå¤šèªè¨€ã€‚                                   |
| **ASCII**                    | è‹±æ–‡èˆ‡æ§åˆ¶å­—å…ƒçš„åŸºæœ¬ç·¨ç¢¼æ ¼å¼ã€‚                                              |
| **Base32 / Base58 / Base62** | æ›´çŸ­æˆ–æ›´é©åˆæŸäº›æ‡‰ç”¨çš„æ–‡å­—ç·¨ç¢¼ã€‚ä¾‹å¦‚ Bitcoin ä½¿ç”¨ Base58ã€‚                        |

---

## ğŸ” JWTï¼ˆJSON Web Tokenï¼‰

JWT æ˜¯ä¸€ç¨®ç”¨ä¾†åœ¨å…©æ–¹ä¹‹é–“å®‰å…¨å‚³éè³‡è¨Šçš„æ¨™æº–æ ¼å¼ï¼ˆRFC 7519ï¼‰ï¼Œå¸¸ç”¨æ–¼èº«ä»½é©—è­‰ï¼ˆAuthenticationï¼‰å’Œæˆæ¬Šï¼ˆAuthorizationï¼‰ã€‚

### âœ… çµæ§‹ï¼ˆç”±ä¸‰éƒ¨åˆ†çµ„æˆï¼‰ï¼š

```text
xxxxx.yyyyy.zzzzz
```

* **Header**ï¼šèªªæ˜ä½¿ç”¨çš„æ¼”ç®—æ³•å’Œé¡å‹ï¼Œä¾‹å¦‚ï¼š

  ```json
  {
    "alg": "HS256",
    "typ": "JWT"
  }
  ```
* **Payload**ï¼šå¯¦éš›çš„è³‡æ–™å…§å®¹ï¼ˆä¸å¯åŠ å¯†ï¼‰ï¼Œä¾‹å¦‚ï¼š

  ```json
  {
    "sub": "1234567890",
    "name": "Alfred",
    "iat": 1710000000
  }
  ```
* **Signature**ï¼šç”¨å¯†é‘°å° Header å’Œ Payload ç°½åï¼Œç¢ºä¿è³‡æ–™æœªè¢«ç«„æ”¹ã€‚

> ä¸‰å€‹éƒ¨åˆ†éƒ½ä½¿ç”¨ **Base64URL encoding** è™•ç†ï¼ˆé¡ä¼¼ Base64ï¼Œä½†å»é™¤ `+`, `/`, `=` ä»¥é©æ‡‰ URLï¼‰ã€‚

---

### ğŸ“Œ å¸¸è¦‹ç°½åæ¼”ç®—æ³•ï¼ˆalgï¼‰

| æ¼”ç®—æ³•   | é¡å‹          | èªªæ˜                      |
| ----- | ----------- | ----------------------- |
| HS256 | å°ç¨±å¼ï¼ˆHMACï¼‰   | ä½¿ç”¨åŒä¸€å¯†é‘°é€²è¡Œç°½åèˆ‡é©—è­‰           |
| RS256 | éå°ç¨±å¼ï¼ˆRSAï¼‰   | ä½¿ç”¨ç§é‘°ç°½åã€å…¬é‘°é©—è­‰             |
| ES256 | éå°ç¨±å¼ï¼ˆECDSAï¼‰ | ä½¿ç”¨ elliptic curveï¼Œè¼ƒçŸ­æ›´å®‰å…¨ |

---

### ğŸ§  JWT çš„æ‡‰ç”¨å ´æ™¯

* Web ç™»å…¥çš„ Token-based èªè­‰ï¼ˆå–ä»£ sessionï¼‰
* OAuth 2.0 / OpenID Connect çš„ access tokenã€ID token
* å¾®æœå‹™ä¹‹é–“çš„èº«ä»½é©—è­‰
* API æˆæ¬Šæ§åˆ¶ï¼ˆscopesï¼‰

---

### ğŸš« JWT çš„å¸¸è¦‹èª¤ç”¨è­¦å‘Š

* **ä¸è¦å„²å­˜æ•æ„Ÿè³‡æ–™**ï¼ˆå¦‚å¯†ç¢¼ï¼‰åœ¨ Payloadï¼Œå› ç‚ºå®ƒæ˜¯æ˜æ–‡ Base64 å¯è§£ç¢¼ã€‚
* é¿å…ä½¿ç”¨ç„¡ç°½åçš„æ¼”ç®—æ³•ï¼ˆå¦‚ `alg: none`ï¼‰ã€‚
* è¦å¦¥å–„ç®¡ç† token çš„éæœŸï¼ˆ`exp`ï¼‰èˆ‡æ›´æ–°æ©Ÿåˆ¶ã€‚

å¤ªå¥½äº†ï¼ä»¥ä¸‹æ˜¯æ›´å¯¦ç”¨çš„è£œå……ï¼ŒåŒ…æ‹¬ï¼š

---

## ğŸ§ª JWT ç¯„ä¾‹èˆ‡è§£ç¢¼èªªæ˜

### ğŸ”§ JWT ç¯„ä¾‹

é€™æ˜¯ä¸€å€‹å…¸å‹çš„ JWTï¼š

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.
eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkFsZnJlZCIsImlhdCI6MTUxNjIzOTAyMn0.
SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
```

### ğŸ§© å„éƒ¨åˆ†è§£ç¢¼å¾Œçš„å…§å®¹ï¼š

#### Headerï¼ˆBase64URL decodeï¼‰

```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

#### Payloadï¼ˆBase64URL decodeï¼‰

```json
{
  "sub": "1234567890",
  "name": "Alfred",
  "iat": 1516239022
}
```

#### Signatureï¼ˆé©—è­‰é€™å…©æ®µå…§å®¹æ˜¯å¦è¢«ç«„æ”¹ï¼‰

é€™æ®µç”±ä¼ºæœå™¨ä½¿ç”¨å¯†é‘°ç”¢ç”Ÿï¼š

```
HMACSHA256(
  base64UrlEncode(header) + "." + base64UrlEncode(payload),
  secret
)
```

---

## ğŸ›  ç·šä¸Šå·¥å…·æ¨è–¦

| å·¥å…·                                                | ç”¨é€”                               |
| ------------------------------------------------- | -------------------------------- |
| [jwt.io](https://jwt.io/)                         | JWT è§£ç¢¼èˆ‡ç°½åæ¼”ç®—æ³•è¦–è¦ºåŒ–ï¼Œæ”¯æ´ HS256/RS256 ç­‰ |
| [base64decode.org](https://www.base64decode.org/) | Base64 è§£ç¢¼å·¥å…·                      |
| [CyberChef](https://gchq.github.io/CyberChef/)    | è¶…å¼·è¬ç”¨ç·¨ç¢¼/è§£ç¢¼/åŠ å¯†å·¥å…·                   |

---

## ğŸ§‘â€ğŸ’» JWT ç¨‹å¼ç¢¼ç¯„ä¾‹ï¼ˆä½¿ç”¨ JavaScriptï¼‰

### ç”¨ `jsonwebtoken` å¥—ä»¶ç”¢ç”Ÿ JWTï¼š

```bash
npm install jsonwebtoken
```

```js
const jwt = require('jsonwebtoken');

const payload = {
  sub: "1234567890",
  name: "Alfred",
  iat: Math.floor(Date.now() / 1000),
};

const secret = 'my-secret';

const token = jwt.sign(payload, secret, { algorithm: 'HS256' });
console.log(token);
```

### é©—è­‰ JWTï¼š

```js
const decoded = jwt.verify(token, secret);
console.log(decoded);
```

---

## ğŸ¤” å¸¸è¦‹ JWT Payload æ¬„ä½ï¼ˆClaimï¼‰

| æ¬„ä½    | æ„ç¾©                   |
| ----- | -------------------- |
| `iss` | ç™¼è¡Œè€… (issuer)         |
| `sub` | ä¸»é«” (subject)         |
| `aud` | å—çœ¾ (audience)        |
| `exp` | éæœŸæ™‚é–“ï¼ˆUnix timestampï¼‰ |
| `nbf` | åœ¨æ­¤æ™‚é–“å‰ä¸æ¥å—ï¼ˆNot beforeï¼‰ |
| `iat` | ç™¼è¡Œæ™‚é–“ï¼ˆIssued atï¼‰      |
| `jti` | JWT IDï¼Œå”¯ä¸€è­˜åˆ¥ç¢¼         |